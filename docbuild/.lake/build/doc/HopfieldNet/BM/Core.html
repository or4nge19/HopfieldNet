<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../.././style.css"></link><link rel="icon" href="../.././favicon.svg"></link><link rel="mask-icon" href="../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../.././/declarations/declaration-data.bmp" as="image"></link><title>HopfieldNet.BM.Core</title><script defer="true" src="../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../.././";</script><script>const MODULE_NAME="HopfieldNet.BM.Core";</script><script type="module" src="../.././jump-src.js"></script><script type="module" src="../.././search.js"></script><script type="module" src="../.././expand-nav.js"></script><script type="module" src="../.././how-about.js"></script><script type="module" src="../.././instances.js"></script><script type="module" src="../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">HopfieldNet</span>.<span class="name">BM</span>.<span class="name">Core</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/d669253cbe19c6ce4cd103939fa32fb81c26d54b/HopfieldNet/BM/Core.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../.././Init.html">Init</a></li><li><a href="../.././HopfieldNet/HN/Core.html">HopfieldNet.HN.Core</a></li><li><a href="../.././Mathlib/Order/CompletePartialOrder.html">Mathlib.Order.CompletePartialOrder</a></li><li><a href="../.././Mathlib/Algebra/Lie/OfAssociative.html">Mathlib.Algebra.Lie.OfAssociative</a></li><li><a href="../.././Mathlib/Data/Real/StarOrdered.html">Mathlib.Data.Real.StarOrdered</a></li><li><a href="../.././Mathlib/Probability/Distributions/Uniform.html">Mathlib.Probability.Distributions.Uniform</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-HopfieldNet.BM.Core" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#BM_pact_of_HNfact"><span class="name">BM_pact_of_HNfact</span></a></div><div class="nav_link"><a class="break_within" href="#BoltzmannMachine"><span class="name">BoltzmannMachine</span></a></div><div class="nav_link"><a class="break_within" href="#ParamsBM"><span class="name">ParamsBM</span></a></div><div class="nav_link"><a class="break_within" href="#StateBM"><span class="name">StateBM</span></a></div><div class="nav_link"><a class="break_within" href="#BoltzmannMachine.energy"><span class="name">BoltzmannMachine</span>.<span class="name">energy</span></a></div><div class="nav_link"><a class="break_within" href="#BoltzmannMachine.localField"><span class="name">BoltzmannMachine</span>.<span class="name">localField</span></a></div><div class="nav_link"><a class="break_within" href="#BoltzmannMachine.probNeuronIsOne"><span class="name">BoltzmannMachine</span>.<span class="name">probNeuronIsOne</span></a></div><div class="nav_link"><a class="break_within" href="#BoltzmannMachine.probNeuronIsOne_nonneg"><span class="name">BoltzmannMachine</span>.<span class="name">probNeuronIsOne_nonneg</span></a></div><div class="nav_link"><a class="break_within" href="#BoltzmannMachine.probNeuronIsOne_le_one"><span class="name">BoltzmannMachine</span>.<span class="name">probNeuronIsOne_le_one</span></a></div><div class="nav_link"><a class="break_within" href="#BoltzmannMachine.gibbsUpdateSingleNeuron"><span class="name">BoltzmannMachine</span>.<span class="name">gibbsUpdateSingleNeuron</span></a></div><div class="nav_link"><a class="break_within" href="#BoltzmannMachine.gibbsSamplingStep"><span class="name">BoltzmannMachine</span>.<span class="name">gibbsSamplingStep</span></a></div></nav><main>
<div class="mod_doc"><h1 class="markdown-heading" id="Boltzmann-Machine-Neural-Network">Boltzmann Machine Neural Network <a class="hover-link" href="#Boltzmann-Machine-Neural-Network">#</a></h1><p>This file defines Boltzmann Machines (BMs), a type of stochastic recurrent neural network with symmetric
connectivity between units and no self-connections.</p><p>This module extends the deterministic Hopfield network with stochastic dynamics: a fully‐connected,
symmetric weight network without self‐loops and binary activations <code>{1, ‐1}</code>.
We implement the Boltzmann Machine inside our <code><a href="../.././HopfieldNet/NN.html#NeuralNetwork">NeuralNetwork</a></code> framework, providing:</p><p>• <code><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine">BoltzmannMachine</a></code> : the network instance
• <code><a href="../.././HopfieldNet/BM/Core.html#ParamsBM">ParamsBM</a></code>, <code><a href="../.././HopfieldNet/BM/Core.html#StateBM">StateBM</a></code> : parameter and state types
• <code><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.energy">energy</a></code> / <code><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.localField">localField</a></code> / <code><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.probNeuronIsOne">probNeuronIsOne</a></code> : key statistics
• <code><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.gibbsUpdateSingleNeuron">gibbsUpdateSingleNeuron</a></code> / <code><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.gibbsSamplingStep">gibbsSamplingStep</a></code> : Gibbs sampler</p><h2 class="markdown-heading" id="Mathematics">Mathematics <a class="hover-link" href="#Mathematics">#</a></h2><p>Boltzmann Machines have binary neurons (±1) with probability of activation determined by:</p><ul>
<li>Energy function: $E(s) = -\frac{1}{2}\sum_{u,v, u \neq v} w_{u,v}s_u s_v - \sum_u \theta_u s_u$</li>
<li>Probability distribution: $P(s) \propto \exp(-E(s)/T)$ where $T$ is the temperature parameter</li>
<li>Local field for neuron $u$: $L_u(s) = \sum_{v \neq u} w_{u,v}s_v + \theta_u$</li>
<li>Probability of neuron $u$ being 1: $P(s_u = 1) = \frac{1}{1 + \exp(-2L_u(s)/T)}$</li>
</ul><p>The network uses Gibbs sampling to generate samples from the underlying probability distribution.</p></div><div class="decl" id="BM_pact_of_HNfact"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/d669253cbe19c6ce4cd103939fa32fb81c26d54b/HopfieldNet/BM/Core.lean#L37-L42">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././HopfieldNet/BM/Core.html#BM_pact_of_HNfact"><span class="name">BM_pact_of_HNfact</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">θ </span><span class="fn">val</span> : <span class="fn">R</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">(fun (<span class="fn">act</span> : <span class="fn">R</span>) =&gt; <span class="fn">act</span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">1</span> <a href="../.././Init/Prelude.html#Or">∨</a> <span class="fn">act</span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">-<span class="fn">1</span></span>)</span> <span class="fn">(<a href="../.././HopfieldNet/HN/Core.html#HNfact">HNfact</a> <span class="fn">θ</span> <span class="fn">val</span>)</span></span></div></div></div></div><div class="decl" id="BoltzmannMachine"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/d669253cbe19c6ce4cd103939fa32fb81c26d54b/HopfieldNet/BM/Core.lean#L46-L69">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine"><span class="name">BoltzmannMachine</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">R </span><span class="fn">U</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././HopfieldNet/NN.html#NeuralNetwork">NeuralNetwork</a> <span class="fn">R</span> <span class="fn">U</span></span></div></div><p><code><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine">BoltzmannMachine</a></code> defines a Boltzmann Machine neural network.
It extends <code><a href="../.././HopfieldNet/HN/Core.html#HopfieldNetwork">HopfieldNetwork</a></code> with specific properties:</p><ul>
<li>Neurons are fully connected (except to themselves).</li>
<li>All neurons are both input and output neurons.</li>
<li>Weights are symmetric, and self-weights are zero.</li>
<li>Activation is binary (1 or -1).</li>
</ul><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-BoltzmannMachine" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="ParamsBM"><div class="structure"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/d669253cbe19c6ce4cd103939fa32fb81c26d54b/HopfieldNet/BM/Core.lean#L71-L84">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././HopfieldNet/BM/Core.html#ParamsBM"><span class="name">ParamsBM</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">R </span><span class="fn">U</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>Parameters for a Boltzmann Machine.</p><ul class="structure_fields" id="ParamsBM.mk"><li id="ParamsBM.w" class="structure_field"><div class="structure_field_info">w : <span class="fn"><a href="../.././Mathlib/Data/Matrix/Defs.html#Matrix">Matrix</a> <span class="fn">U</span> <span class="fn">U</span> <span class="fn">R</span></span></div><div class="structure_field_doc"><p>The weight matrix of the Boltzmann Machine.</p></div></li><li id="ParamsBM.hpw" class="structure_field"><div class="structure_field_info">hpw : <span class="fn"><span class="fn"><span class="fn">(<a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine">BoltzmannMachine</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href="../.././HopfieldNet/NN.html#NeuralNetwork.pw">pw</a></span> <span class="fn"><span class="fn">self</span>.<a href="../.././HopfieldNet/BM/Core.html#ParamsBM.w">w</a></span></span></div><div class="structure_field_doc"><p>Proof that the weight matrix satisfies the properties required by <code>BoltzmannMachine.pw</code>.</p></div></li><li id="ParamsBM.θ" class="structure_field"><div class="structure_field_info">θ : <span class="fn"><span class="fn">U</span> → <span class="fn">R</span></span></div><div class="structure_field_doc"><p>A function mapping each neuron to its threshold value.</p></div></li><li id="ParamsBM.T" class="structure_field"><div class="structure_field_info">T : <span class="fn">R</span></div><div class="structure_field_doc"><p>The temperature parameter of the Boltzmann Machine.</p></div></li><li id="ParamsBM.hT_pos" class="structure_field"><div class="structure_field_info">hT_pos : <span class="fn"><span class="fn">self</span>.<a href="../.././HopfieldNet/BM/Core.html#ParamsBM.T">T</a></span> <a href="../.././Init/Prelude.html#GT.gt">&gt;</a> <span class="fn">0</span></div><div class="structure_field_doc"><p>Proof that the temperature <code><a href="../.././HopfieldNet/BM/Core.html#ParamsBM.T">T</a></code> is positive.</p></div></li></ul><details id="instances-for-list-ParamsBM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="StateBM"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/d669253cbe19c6ce4cd103939fa32fb81c26d54b/HopfieldNet/BM/Core.lean#L86-L91">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././HopfieldNet/BM/Core.html#StateBM"><span class="name">StateBM</span></a></span><span class="decl_args">
<span class="fn">(<span class="fn">R </span><span class="fn">U</span> : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p><code><a href="../.././HopfieldNet/BM/Core.html#StateBM">StateBM</a></code> is an alias for the state of a <code><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine">BoltzmannMachine</a></code>.
It represents the activation values of all neurons in the network.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././HopfieldNet/BM/Core.html#StateBM">StateBM</a> <span class="fn">R</span> <span class="fn">U</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">(<a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine">BoltzmannMachine</a> <span class="fn">R</span> <span class="fn">U</span>)</span>.<a href="../.././HopfieldNet/NN.html#NeuralNetwork.State">State</a></span></li></ul></details><details id="instances-for-list-StateBM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="BoltzmannMachine.energy"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/d669253cbe19c6ce4cd103939fa32fb81c26d54b/HopfieldNet/BM/Core.lean#L95-L104">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.energy"><span class="name">BoltzmannMachine</span>.<span class="name">energy</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#ParamsBM">ParamsBM</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#StateBM">StateBM</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">R</span></div></div><p>Calculates the energy of a state <code>s</code> in a Boltzmann Machine.</p><p>The energy is defined as:
$$E(s) = -\frac{1}{2}\sum_{u,v, u \neq v} w_{u,v}s_u s_v - \sum_u \theta_u s_u$$
where $w$ is the weight matrix, $s$ is the state (activations), and $\theta$ are the thresholds.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.energy">BoltzmannMachine.energy</a> <span class="fn">p</span> <span class="fn">s</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <a href="../.././Init/Prelude.html#Neg.neg">-</a><span class="fn">(<span class="fn">1</span> / <span class="fn">2</span>)</span> <a href="../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn">∑ <span class="fn">u</span> : <span class="fn">U</span>, <span class="fn">∑ <span class="fn">v</span> : <span class="fn">U </span>with <span class="fn">v</span> <a href="../.././Init/Core.html#Ne">≠</a> <span class="fn">u</span>, <span class="fn"><span class="fn"><span class="fn">p</span>.<a href="../.././HopfieldNet/BM/Core.html#ParamsBM.w">w</a></span> <span class="fn">u</span> <span class="fn">v</span></span> <a href="../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href="../.././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span> <a href="../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href="../.././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span></span></span> <a href="../.././Init/Prelude.html#HSub.hSub">-</a> <span class="fn">∑ <span class="fn">u</span> : <span class="fn">U</span>, <span class="fn"><span class="fn"><span class="fn">p</span>.<a href="../.././HopfieldNet/BM/Core.html#ParamsBM.θ">θ</a></span> <span class="fn">u</span></span> <a href="../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href="../.././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">u</span></span></span></li></ul></details><details id="instances-for-list-BoltzmannMachine.energy" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="BoltzmannMachine.localField"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/d669253cbe19c6ce4cd103939fa32fb81c26d54b/HopfieldNet/BM/Core.lean#L106-L114">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.localField"><span class="name">BoltzmannMachine</span>.<span class="name">localField</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#ParamsBM">ParamsBM</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#StateBM">StateBM</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn">R</span></div></div><p>Calculates the local field for a neuron <code>u</code> in a Boltzmann Machine.</p><p>The local field is the sum of weighted inputs from other neurons plus the neuron's own threshold:
$$L_u(s) = \sum_{v \neq u} w_{u,v}s_v + \theta_u$$
where $w$ is the weight matrix, $s$ is the state (activations), and $\theta_u$ is the threshold for neuron $u$.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.localField">BoltzmannMachine.localField</a> <span class="fn">p</span> <span class="fn">s</span> <span class="fn">u</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">∑ <span class="fn">v</span> : <span class="fn">U </span>with <span class="fn">v</span> <a href="../.././Init/Core.html#Ne">≠</a> <span class="fn">u</span>, <span class="fn"><span class="fn"><span class="fn">p</span>.<a href="../.././HopfieldNet/BM/Core.html#ParamsBM.w">w</a></span> <span class="fn">u</span> <span class="fn">v</span></span> <a href="../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><span class="fn"><span class="fn">s</span>.<a href="../.././HopfieldNet/NN.html#NeuralNetwork.State.act">act</a></span> <span class="fn">v</span></span></span> <a href="../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><span class="fn"><span class="fn">p</span>.<a href="../.././HopfieldNet/BM/Core.html#ParamsBM.θ">θ</a></span> <span class="fn">u</span></span></li></ul></details><details id="instances-for-list-BoltzmannMachine.localField" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="BoltzmannMachine.probNeuronIsOne"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/d669253cbe19c6ce4cd103939fa32fb81c26d54b/HopfieldNet/BM/Core.lean#L116-L127">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.probNeuronIsOne"><span class="name">BoltzmannMachine</span>.<span class="name">probNeuronIsOne</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href="../.././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#ParamsBM">ParamsBM</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#StateBM">StateBM</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Mathlib/Data/Real/Basic.html#Real">ℝ</a></div></div><p>Calculates the probability of neuron <code>u</code> being in state <code>1</code> (activated).</p><p>The probability is given by the sigmoid function of the local field:
$$P(s_u = 1) = \frac{1}{1 + \exp(-2L_u(s)/T)}$$
where $L_u(s)$ is the local field for neuron $u$ and $T$ is the temperature.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.probNeuronIsOne">BoltzmannMachine.probNeuronIsOne</a> <span class="fn">p</span> <span class="fn">s</span> <span class="fn">u</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn">1</span> <a href="../.././Init/Prelude.html#HDiv.hDiv">/</a> (<span class="fn">1</span> <a href="../.././Init/Prelude.html#HAdd.hAdd">+</a> <span class="fn"><a href="../.././Mathlib/Data/Complex/Exponential.html#Real.exp">Real.exp</a> (<a href="../.././Init/Prelude.html#Neg.neg">-</a>(<span class="fn">2</span> <a href="../.././Init/Prelude.html#HMul.hMul">*</a> <span class="fn"><a href="../.././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn">(<a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.localField">BoltzmannMachine.localField</a> <span class="fn">p</span> <span class="fn">s</span> <span class="fn">u</span>)</span></span> <a href="../.././Init/Prelude.html#HDiv.hDiv">/</a> <span class="fn"><a href="../.././Init/Coe.html#Coe.coe">Coe.coe</a> <span class="fn"><span class="fn">p</span>.<a href="../.././HopfieldNet/BM/Core.html#ParamsBM.T">T</a></span></span>))</span>)</li></ul></details><details id="instances-for-list-BoltzmannMachine.probNeuronIsOne" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="mod_doc"><h2 class="markdown-heading" id="Probability-of-a-Neuron-Being-One">Probability of a Neuron Being One <a class="hover-link" href="#Probability-of-a-Neuron-Being-One">#</a></h2><p>This section defines properties related to the probability of a specific neuron being in state '1'
in a Boltzmann Machine.</p></div><div class="decl" id="BoltzmannMachine.probNeuronIsOne_nonneg"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/d669253cbe19c6ce4cd103939fa32fb81c26d54b/HopfieldNet/BM/Core.lean#L136-L143">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.probNeuronIsOne_nonneg"><span class="name">BoltzmannMachine</span>.<span class="name">probNeuronIsOne_nonneg</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href="../.././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#ParamsBM">ParamsBM</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#StateBM">StateBM</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.probNeuronIsOne">probNeuronIsOne</a> <span class="fn">p</span> <span class="fn">s</span> <span class="fn">u</span></span> <a href="../.././Init/Prelude.html#GE.ge">≥</a> <span class="fn">0</span></div></div><p>The probability of a neuron <code>u</code> being in state '1' is always non-negative.</p></div></div><div class="decl" id="BoltzmannMachine.probNeuronIsOne_le_one"><div class="theorem"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/d669253cbe19c6ce4cd103939fa32fb81c26d54b/HopfieldNet/BM/Core.lean#L145-L153">source</a></div><div class="decl_header"><span class="decl_kind">theorem</span>
<span class="decl_name"><a class="break_within" href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.probNeuronIsOne_le_one"><span class="name">BoltzmannMachine</span>.<span class="name">probNeuronIsOne_le_one</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href="../.././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#ParamsBM">ParamsBM</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#StateBM">StateBM</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.probNeuronIsOne">probNeuronIsOne</a> <span class="fn">p</span> <span class="fn">s</span> <span class="fn">u</span></span> <a href="../.././Init/Prelude.html#LE.le">≤</a> <span class="fn">1</span></div></div><p>The probability of a neuron <code>u</code> being in state '1' is always less than or equal to 1.</p></div></div><div class="decl" id="BoltzmannMachine.gibbsUpdateSingleNeuron"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/d669253cbe19c6ce4cd103939fa32fb81c26d54b/HopfieldNet/BM/Core.lean#L155-L179">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.gibbsUpdateSingleNeuron"><span class="name">BoltzmannMachine</span>.<span class="name">gibbsUpdateSingleNeuron</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href="../.././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#ParamsBM">ParamsBM</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#StateBM">StateBM</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">u</span> : <span class="fn">U</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Mathlib/Probability/ProbabilityMassFunction/Basic.html#PMF">PMF</a> <span class="fn">(<a href="../.././HopfieldNet/BM/Core.html#StateBM">StateBM</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span></div></div><p>Updates a single neuron <code>u</code> in state <code>s</code> according to the Gibbs distribution.</p><p>The neuron's new state (1 or -1) is chosen probabilistically based on <code><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.probNeuronIsOne">probNeuronIsOne</a></code>.
Returns a probability mass function over the possible next states.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-BoltzmannMachine.gibbsUpdateSingleNeuron" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="BoltzmannMachine.gibbsSamplingStep"><div class="def"><div class="gh_link"><a href="https://github.com/mkaratarakis/HopfieldNet/blob/d669253cbe19c6ce4cd103939fa32fb81c26d54b/HopfieldNet/BM/Core.lean#L181-L191">source</a></div><div class="decl_header"><span class="decl_kind">noncomputable def</span>
<span class="decl_name"><a class="break_within" href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.gibbsSamplingStep"><span class="name">BoltzmannMachine</span>.<span class="name">gibbsSamplingStep</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{<span class="fn">R </span><span class="fn">U</span> : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Field/Defs.html#Field">Field</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Order/Defs/LinearOrder.html#LinearOrder">LinearOrder</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Algebra/Order/Ring/Defs.html#IsStrictOrderedRing">IsStrictOrderedRing</a> <span class="fn">R</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#DecidableEq">DecidableEq</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Mathlib/Data/Fintype/Defs.html#Fintype">Fintype</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">U</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Coe.html#Coe">Coe</a> <span class="fn">R</span> <a href="../.././Mathlib/Data/Real/Basic.html#Real">ℝ</a></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(<span class="fn">p</span> : <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#ParamsBM">ParamsBM</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(<span class="fn">s</span> : <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#StateBM">StateBM</a> <span class="fn">R</span> <span class="fn">U</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Mathlib/Probability/ProbabilityMassFunction/Basic.html#PMF">PMF</a> <span class="fn">(<a href="../.././HopfieldNet/BM/Core.html#StateBM">StateBM</a> <span class="fn">R</span> <span class="fn">U</span>)</span></span></div></div><p>Performs one step of Gibbs sampling.</p><p>A neuron <code>u</code> is chosen uniformly at random from all neurons,
and then its state is updated according to <code><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.gibbsUpdateSingleNeuron">gibbsUpdateSingleNeuron</a></code>.
Returns a probability mass function over the possible next states.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.gibbsSamplingStep">BoltzmannMachine.gibbsSamplingStep</a> <span class="fn">p</span> <span class="fn">s</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">u</span> ← <span class="fn"><a href="../.././Mathlib/Probability/Distributions/Uniform.html#PMF.uniformOfFintype">PMF.uniformOfFintype</a> <span class="fn">U</span></span>
  <span class="fn"><a href="../.././HopfieldNet/BM/Core.html#BoltzmannMachine.gibbsUpdateSingleNeuron">BoltzmannMachine.gibbsUpdateSingleNeuron</a> <span class="fn">p</span> <span class="fn">s</span> <span class="fn">u</span></span></span></li></ul></details><details id="instances-for-list-BoltzmannMachine.gibbsSamplingStep" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>